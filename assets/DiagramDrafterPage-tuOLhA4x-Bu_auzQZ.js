import{y as N,m as $,v as d,u as e,Y as p,a as n,l as C,d as h}from"./index-CL7HjhdV.js";import{b as m}from"./Card-C8Vt2KLr-CXW7Tvcj.js";import{d as I}from"./geminiService-DJIPhCmJ-Bm2owfCC.js";import{a as S}from"./downloadHelper-Y0t7dfPR--lPmL3re.js";const E=()=>{const{addToast:r}=N(),{openSaveToDriveModal:j}=$(),[t,x]=d.useState(""),[s,c]=d.useState(null),[i,f]=d.useState(!1),[u,l]=d.useState(null),[o,b]=d.useState("image/jpeg"),k=d.useCallback(async()=>{if(!t.trim()){l("Please enter a description for your diagram."),r("Diagram description is empty.","warning");return}f(!0),l(null),c(null);const a=await I(t);b("image/jpeg"),a.error?(l(a.error),r(a.error,"error")):a.base64Image?(c(a.base64Image),r("Diagram generated successfully!","success")):(l("No image data received from the AI."),r("No image data received.","error")),f(!1)},[t,r]),v=()=>{if(!s){r("No image to download.","info");return}const a=`data:${o};base64,${s}`,g=t.substring(0,30).replace(/[^\w\s-]/gi,"").replace(/\s+/g,"_")||"Diagram",D=`${h}_DiagramDrafter_${g}.${o==="image/png"?"png":"jpg"}`;S(a,D),r("Image download initiated.","success")},y=()=>{if(!s){r("No image to save.","info");return}const a=t.substring(0,30).replace(/[^\w\s-]/gi,"").replace(/\s+/g,"_")||"Diagram",g=`${h}_DiagramDrafter_${a}.${o==="image/png"?"png":"jpg"}`;j(s,g,o)},w=()=>{x(""),c(null),l(null),r("Input and image cleared.","info")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"pb-4",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-foreground dark:text-dark-foreground flex items-center",children:[e.jsx(p,{className:"h-7 w-7 md:h-8 md:w-8 mr-2 text-primary dark:text-dark-primary"}),"Diagram Drafter"]}),e.jsx("p",{className:"mt-1 text-muted-foreground dark:text-dark-muted-foreground",children:"Describe the diagram you need, and let AI visualize it for you."})]}),e.jsxs(m,{title:"Describe Your Diagram",children:[e.jsx("textarea",{value:t,onChange:a=>x(a.target.value),rows:5,className:"w-full p-2.5 border rounded-md focus:ring-2 focus:ring-primary dark:focus:ring-dark-primary focus:border-transparent bg-background dark:bg-dark-input dark:border-dark-border dark:text-dark-foreground dark:placeholder-dark-muted-foreground transition-all",placeholder:"e.g., 'A simple flowchart for a coffee making process', 'Circuit diagram of a full wave rectifier', 'Conceptual diagram of the water cycle'","aria-label":"Diagram description input"}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[(t||s)&&e.jsx(n,{onClick:w,variant:"outline",disabled:i,className:"w-full sm:w-auto",children:"Clear All"}),e.jsx(n,{onClick:k,isLoading:i,disabled:!t.trim(),className:"w-full sm:w-auto",children:"Generate Diagram"})]})]}),e.jsxs("div",{"aria-live":"polite","aria-busy":i,children:[i&&e.jsx(C,{text:"Drafting your diagram, please wait..."}),u&&!i&&e.jsxs(m,{className:"bg-destructive/10 border-destructive text-destructive-foreground dark:bg-destructive/20 dark:text-destructive",children:[e.jsx("p",{className:"font-semibold",children:"Error Generating Diagram"}),e.jsx("p",{className:"text-sm",children:u})]}),!i&&!s&&!u&&!t.trim()&&e.jsx(m,{children:e.jsxs("div",{className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:[e.jsx(p,{className:"h-16 w-16 mx-auto text-primary/30 dark:text-dark-primary/30 mb-4"}),e.jsx("p",{className:"font-semibold text-lg",children:"Ready to Visualize"}),e.jsx("p",{className:"text-sm",children:"Enter your diagram description above to get started."})]})}),!i&&s&&e.jsxs(m,{title:"Generated Diagram",children:[e.jsx("div",{className:"flex justify-center items-center p-4 bg-muted/50 dark:bg-dark-muted/50 rounded-md",children:e.jsx("img",{src:`data:${o};base64,${s}`,alt:"Generated Diagram",className:"max-w-full max-h-[60vh] object-contain rounded-md shadow-md"})}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 justify-end",children:[e.jsx(n,{onClick:v,variant:"outline",size:"sm",children:"Download Image"}),e.jsx(n,{onClick:y,variant:"outline",size:"sm",children:"Save to Google Drive"})]})]})]})]})};export{E as default};
