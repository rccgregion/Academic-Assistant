import{q as N,m as I,r as o,j as e,D as x,c as l,t as C,a as h}from"./index-Cf9C7PVC.js";import{C as m}from"./Card-C8Vt2KLr.js";import{b as S}from"./geminiService-DJIPhCmJ.js";import{a as $}from"./downloadHelper-Y0t7dfPR.js";const E=()=>{const{addToast:r}=N(),{openSaveToDriveModal:j}=I(),[t,f]=o.useState(""),[s,c]=o.useState(null),[i,p]=o.useState(!1),[g,d]=o.useState(null),[n,b]=o.useState("image/jpeg"),k=o.useCallback(async()=>{if(!t.trim()){d("Please enter a description for your diagram."),r("Diagram description is empty.","warning");return}p(!0),d(null),c(null);const a=await S(t);b("image/jpeg"),a.error?(d(a.error),r(a.error,"error")):a.base64Image?(c(a.base64Image),r("Diagram generated successfully!","success")):(d("No image data received from the AI."),r("No image data received.","error")),p(!1)},[t,r]),v=()=>{if(!s){r("No image to download.","info");return}const a=`data:${n};base64,${s}`,u=t.substring(0,30).replace(/[^\w\s-]/gi,"").replace(/\s+/g,"_")||"Diagram",y=`${h}_DiagramDrafter_${u}.${n==="image/png"?"png":"jpg"}`;$(a,y),r("Image download initiated.","success")},D=()=>{if(!s){r("No image to save.","info");return}const a=t.substring(0,30).replace(/[^\w\s-]/gi,"").replace(/\s+/g,"_")||"Diagram",u=`${h}_DiagramDrafter_${a}.${n==="image/png"?"png":"jpg"}`;j(s,u,n)},w=()=>{f(""),c(null),d(null),r("Input and image cleared.","info")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"pb-4",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight text-foreground dark:text-dark-foreground flex items-center",children:[e.jsx(x,{className:"h-7 w-7 md:h-8 md:w-8 mr-2 text-primary dark:text-dark-primary"}),"Diagram Drafter"]}),e.jsx("p",{className:"mt-1 text-muted-foreground dark:text-dark-muted-foreground",children:"Describe the diagram you need, and let AI visualize it for you."})]}),e.jsxs(m,{title:"Describe Your Diagram",children:[e.jsx("textarea",{value:t,onChange:a=>f(a.target.value),rows:5,className:"w-full p-2.5 border rounded-md focus:ring-2 focus:ring-primary dark:focus:ring-dark-primary focus:border-transparent bg-background dark:bg-dark-input dark:border-dark-border dark:text-dark-foreground dark:placeholder-dark-muted-foreground transition-all",placeholder:"e.g., 'A simple flowchart for a coffee making process', 'Circuit diagram of a full wave rectifier', 'Conceptual diagram of the water cycle'","aria-label":"Diagram description input"}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2",children:[(t||s)&&e.jsx(l,{onClick:w,variant:"outline",disabled:i,className:"w-full sm:w-auto",children:"Clear All"}),e.jsx(l,{onClick:k,isLoading:i,disabled:!t.trim(),className:"w-full sm:w-auto",children:"Generate Diagram"})]})]}),e.jsxs("div",{"aria-live":"polite","aria-busy":i,children:[i&&e.jsx(C,{text:"Drafting your diagram, please wait..."}),g&&!i&&e.jsxs(m,{className:"bg-destructive/10 border-destructive text-destructive-foreground dark:bg-destructive/20 dark:text-destructive",children:[e.jsx("p",{className:"font-semibold",children:"Error Generating Diagram"}),e.jsx("p",{className:"text-sm",children:g})]}),!i&&!s&&!g&&!t.trim()&&e.jsx(m,{children:e.jsxs("div",{className:"text-center py-10 text-muted-foreground dark:text-dark-muted-foreground",children:[e.jsx(x,{className:"h-16 w-16 mx-auto text-primary/30 dark:text-dark-primary/30 mb-4"}),e.jsx("p",{className:"font-semibold text-lg",children:"Ready to Visualize"}),e.jsx("p",{className:"text-sm",children:"Enter your diagram description above to get started."})]})}),!i&&s&&e.jsxs(m,{title:"Generated Diagram",children:[e.jsx("div",{className:"flex justify-center items-center p-4 bg-muted/50 dark:bg-dark-muted/50 rounded-md",children:e.jsx("img",{src:`data:${n};base64,${s}`,alt:"Generated Diagram",className:"max-w-full max-h-[60vh] object-contain rounded-md shadow-md"})}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2 justify-end",children:[e.jsx(l,{onClick:v,variant:"outline",size:"sm",children:"Download Image"}),e.jsx(l,{onClick:D,variant:"outline",size:"sm",children:"Save to Google Drive"})]})]})]})]})};export{E as default};
